SELECT c.primary_name, c.first_name, c.nickname, p1.primary_name, p1.first_name, p1.nickname, p2.primary_name, p2.first_name, p2.nickname, a.street_address_1, a.street_address_2, a.city, a.state, a.postal_code, a.country, r.year, g.`group` , g.short_name, t.amount AS tuition, t.due_date, p.amount AS payment, min( at.rank ) FROM contacts AS cJOIN address_associations AS aa ON c.contact_id = aa.contact_idJOIN addresses AS a ON aa.address_id = a.address_idJOIN address_types AS at ON a.address_type_id = at.address_type_idJOIN roster_memberships AS m ON m.contact_id = c.contact_idJOIN rosters AS r ON m.roster_id = r.roster_idJOIN groups AS g ON r.group_id = g.group_idJOIN tuitions AS t ON t.roster_id = r.roster_idLEFT  JOIN payments AS p ON p.tuition_id = t.tuition_id AND p.contact_id = c.contact_idLEFT  JOIN relationships AS rel1 ON rel1.contact_id = c.contact_idLEFT  JOIN relationship_types AS rt1 ON rt1.relationship_type_id = rel1.relationship_type_idLEFT  JOIN contacts AS p1 ON p1.contact_id = rel1.relative_id AND rt1.relationship_type =  'Parent'LEFT  JOIN relationships AS rel2 ON rel2.contact_id = c.contact_idLEFT  JOIN relationship_types AS rt2 ON rt2.relationship_type_id = rel2.relationship_type_idLEFT  JOIN contacts AS p2 ON p2.contact_id = rel2.relative_id AND rt2.relationship_type =  'Parent'WHERE r.year =  '2005' AND ( p1.contact_id <> p2.contact_id OR p1.contact_id IS  NULL  )/* AND p.modified >=  '[variable]' */GROUP  BY c.contact_idORDER  BY g.`group`  ASC , c.primary_name ASC , c.first_name ASC , p1.contact_id ASC , p2.contact_id ASC;