SELECT c. * , a. * , r.year, g.`group` , g.short_name, l.role, parent.first_name AS parent_first_name, parent.middle_name AS parent_middle_name, parent.primary_name AS parent_primary_name, parent.nickname AS parent_nickname, parent2.first_name AS parent2_first_name, parent2.middle_name AS parent2_middle_name, parent2.primary_name AS parent2_primary_name, parent2.nickname AS parent2_nickname, min( types.rank )  AS address_rankFROM contacts AS cJOIN address_associations AS assoc ON c.contact_id = assoc.contact_idJOIN addresses AS a ON assoc.address_id = a.address_idJOIN address_types AS types ON a.address_type_id = types.address_type_idJOIN roster_memberships AS m ON m.contact_id = c.contact_idJOIN rosters AS r ON m.roster_id = r.roster_idJOIN groups AS g ON r.group_id = g.group_idJOIN roles AS l ON m.role_id = l.role_idLEFT  JOIN relationships AS rel ON rel.contact_id = c.contact_idLEFT  JOIN contacts AS parent ON parent.contact_id = rel.relative_idLEFT  JOIN relationship_types AS rt ON rt.relationship_type_id = rel.relationship_type_id AND rt.relationship_type =  'Parent'LEFT  JOIN relationships AS rel2 ON rel2.contact_id = parent.contact_idLEFT  JOIN contacts AS parent2 ON parent2.contact_id = rel2.relative_idLEFT  JOIN relationship_types AS rt2 ON rt2.relationship_type_id = rel2.relationship_type_id AND rt2.relationship_type =  'Spouse/Partner'WHERE r.year =2004 AND ( l.role =  'Trekker' OR l.role =  'QM' OR l.role =  'CA' )GROUP  BY c.contact_idORDER  BY g.`group`  ASC , c.primary_name ASC , c.first_name ASC;